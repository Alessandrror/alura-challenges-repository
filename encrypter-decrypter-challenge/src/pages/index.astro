---
import Layout from "../layouts/Layout.astro"
import Wrapper from "@components/Wrapper.astro"

import data from "@components/app"
---

<Layout title="Encrypter">
  <body id="body-modal">
    <header class="header">
      <div class="logo">
        <span class="element"></span>
        <a href="https://www.aluracursos.com/" target="_blank"
          ><img src="img/logo-vector.svg" alt="Logo" /></a
        >
      </div>
      <div class="title">
        <h1>ENCRIPTADOR DE TEXTO</h1>
      </div>
    </header>
    <main class="main">
      <Wrapper />
    </main>
    <footer class="footer">
      <div class="attribution">
        <p>
          Challenge by: <a
            href="https://www.oracle.com/ar/education/oracle-next-education/"
            target="_blank">Oracle ONE</a
          >. Provided by: <a href="https://www.aluracursos.com/" target="_blank"
            >Alura Latam</a
          >. Coded by: <a target="_blank" href="https://github.com/alessandrror"
            >Alessandro Rivas</a
          >.
        </p>
      </div>
    </footer>
  </body>
</Layout>

<style>
  body {
    font-size: 1rem;
    background-color: var(--lightblue100);
    min-height: 100%;
    display: grid;
    grid-template-areas:
      "header"
      "main"
      "footer";
    grid-template-columns: 1fr;
    grid-template-rows: auto auto auto;
  }

  .header {
    width: 100%;
    grid-area: header;
    grid-column: 1/3;
    grid-row: 1/2;
		margin-top: 1.25rem;
    display: flex;
    flex-direction: row;
  }

  .logo {
    width: 5%;
    margin: 2rem 0 0 4rem;
    position: relative;
  }

  .element {
    position: absolute;
    margin: 2.4rem 0 0 1.6rem;
    animation: lumine 0.85s infinite;
  }

  .title {
    display: flex;
    justify-content: center;
    align-items: center;
    width: 75%;
    height: 4.8rem;
    margin: 2rem 0 0 4rem;

    & h1 {
      color: var(--darkblue300);
      text-align: center;
      font-size: 2.5rem;
      font-family: "Inter", sans-serif;
      font-style: normal;
      font-weight: 700;
      padding-right: 1rem;
    }
  }

  .main {
    width: 100%;
    height: 100%;
    grid-area: main;
    grid-column: 1/3;
    grid-row: 2/3;

    display: grid;
    grid-template-areas:
      "section1"
      "section2"
      "section3";
    grid-template-columns: 1fr;
    grid-template-rows: auto auto auto;
  }

  .footer {
    grid-area: footer;
    grid-column: 1/4;
    grid-row: 3/4;
		display: flex;
		justify-content: center;
		align-items: end;
  }

  .attribution {
    text-align: center;
    font-family: "Inter", sans-serif;
    font-weight: 700;
    font-style: normal;

    & p {
      font-size: 1rem;
      color: var(--gray300);
			margin-bottom: 0.5rem;
    }

    & a {
      font-size: 1.2rem;
      color: var(--darkblue200);
    }
  }

  .bg-modal {
    position: absolute;
    width: 100vw;
    height: 100vh;
    background-color: black;
    opacity: 0.7;
  }

  .modal-rel {
    position: relative;
  }

  .modal-abs {
    background-color: var(--lightblue100);
    width: 25rem;
    height: 20rem;
    border-radius: 1rem;
    position: absolute;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
    margin: auto;
    padding: 1rem;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;

    & p {
      &:first-child {
        width: 7.5rem;
        height: 7.5rem;
        font-size: 4rem;
        font-weight: 700;
        color: var(--darkblue300);
        text-align: center;
        border: 1rem solid var(--darkblue300);
        border-radius: 20rem;
        margin: 0 0 1rem 0;
      }

      &:nth-child(2) {
        color: var(--darkblue300);
        text-align: center;
        font-size: 2.5rem;
        font-family: "Inter", sans-serif;
        font-style: normal;
        font-weight: 700;
        padding-top: 0.25rem;
        padding-bottom: 0.25rem;
      }

      &:last-child {
        color: var(--gray400);
        text-align: center;
        font-size: 1.5rem;
        font-family: "Inter", sans-serif;
        font-style: normal;
        font-weight: 400;
        padding-top: 0.25rem;
        padding-bottom: 0.25rem;
      }
    }
  }

  @media (min-width: 481px) and (max-width: 1024px) {
    body {
      grid-template-areas:
        "header header"
        "main   main"
        "footer footer";
      grid-template-columns: 1fr 1fr;
      grid-template-rows: auto auto auto;
    }

    .header {
      grid-column: 1/3;
      grid-row: 1/2;

      & h1 {
        font-size: 3rem;
      }
    }

    .main {
      grid-column: 1/3;
      grid-row: 2/3;
    }

    .main-grid {
      grid-template-areas:
        "section1 section1"
        "section2 section2"
        "section3 section3";
      grid-template-columns: 1fr 1fr;
      grid-template-rows: 1fr auto 1fr;
    }

    .footer {
      grid-column: 1/3;
      grid-row: 3/4;
    }

    .modal-abs {
      width: 30rem;
      height: 25rem;

      & p {
        &:first-child {
          width: 9rem;
          height: 9rem;
          font-size: 5rem;
        }

        &:nth-child(2) {
          font-size: 2.7rem;
        }

        &:last-child {
          font-size: 1.8rem;
        }
      }
    }
  }

  @media (min-width: 1025px) {
    body {
      grid-template-areas:
        "header header header"
        "main   main   main"
        "footer footer footer";
      grid-template-columns: auto 100% 1fr;
      grid-template-rows: auto auto auto;
    }

    .header {
      grid-column: 1/3;
      grid-row: 1/2;
    }

    .title {
      & h1 {
        font-size: 3.5rem;
      }
    }

    .main {
      grid-column: 1/3;
      grid-row: 2/3;
    }

    .main-grid {
      grid-template-areas:
        "section1 section1 section2"
        "section1 section1 section2"
        "section3 section3 section2";
      grid-template-columns: 1fr 1fr 1fr;
      grid-template-rows: auto 1fr auto;
    }

    .footer {
      grid-column: 1/3;
      grid-row: 3/4;
      margin-top: 2rem;
    }

    .modal-abs {
      width: 35rem;
      height: 30rem;

      & p {
        &:first-child {
          width: 11rem;
          height: 11rem;
          font-size: 6rem;
        }

        &:nth-child(2) {
          font-size: 3rem;
        }

        &:last-child {
          font-size: 2.2rem;
        }
      }
    }
  }

  @media (prefers-color-scheme: dark) {
    body {
      background-color: #202124;
    }

    .logo {
      & a {
        & img {
          filter: invert(9%) sepia(91%) saturate(1901%) hue-rotate(209deg)
            brightness(97%) contrast(102%);
        }
      }
    }

    .title {
      & h1 {
        filter: invert(9%) sepia(91%) saturate(1901%) hue-rotate(209deg)
          brightness(97%) contrast(102%);
      }
    }

    .attribution {
      & p {
        font-size: 1rem;
        color: var(--darkblue100);
      }

      & a {
        font-size: 1.2rem;
        color: var(--gray100);
      }
    }

    .bg-modal {
      background-color: var(--lightblue300);
      opacity: 0.1;
    }

    .modal-abs {
      background-color: #121212;

      & p {
        &:first-child {
          color: var(--darkblue100);
          border: 1rem solid var(--darkblue100);
        }

        &:nth-child(2) {
          color: var(--darkblue100);
        }

        &:last-child {
          color: var(--gray100);
        }
      }
    }
  }

  @keyframes lumine {
    0% {
      box-shadow: -30px -30px 10px 10px rgba(255, 0, 0, 0.5);
    }
    12.5% {
      box-shadow: 0px -45px 10px 10px rgba(255, 0, 150, 0.5);
    }
    25% {
      box-shadow: 30px -30px 10px 10px rgba(150, 0, 255, 0.5);
    }
    37.5% {
      box-shadow: 45px 0px 10px 10px rgba(0, 0, 255, 0.5);
    }
    50% {
      box-shadow: 30px 30px 10px 10px rgba(0, 255, 255, 0.5);
    }
    62.5% {
      box-shadow: 0px 45px 10px 10px rgba(0, 255, 0, 0.5);
    }
    75% {
      box-shadow: -30px 30px 10px 10px rgba(255, 255, 0, 0.5);
    }
    87.5% {
      box-shadow: -45px 0px 10px 10px rgba(255, 150, 0, 0.5);
    }
    100% {
      box-shadow: -30px -30px 10px 10px rgba(255, 0, 0, 0.5);
    }
  }
</style>

<script is:inline>
let allow = 1;
const arrayEncrip = ["a", "e", "i", "o", "u"];
const arrayDecrip = ["ai", "enter", "imes", "ober", "ufat"];
let text = "";
let rules = 0;
const mayusytildes = [
  "á",
  "é",
  "í",
  "ó",
  "ú",
  "A",
  "B",
  "C",
  "D",
  "E",
  "F",
  "G",
  "H",
  "I",
  "J",
  "K",
  "L",
  "M",
  "N",
  "Ñ",
  "O",
  "P",
  "Q",
  "R",
  "S",
  "T",
  "U",
  "V",
  "W",
  "X",
  "Y",
  "Z",
  "Á",
  "É",
  "Í",
  "Ó",
  "Ú",
  "À",
  "È",
  "Ì",
  "Ò",
  "Ù",
  "Á",
  "É",
  "Í",
  "Ó",
  "Ú",
  "Ý",
  "Â",
  "Ê",
  "Î",
  "Ô",
  "Û",
  "Ã",
  "Ẽ",
  "Ĩ",
  "Õ",
  "Ũ",
  "Ä",
  "Ë",
  "Ï",
  "Ö",
  "Ü",
  "Ÿ",
  "Ç",
];
let show = document.getElementById("info");

function encriptText() {
  text = "";
  let str = document.getElementById("input").value;
  comprobarReglas(mayusytildes, str);
  if (str === "" || rules) {
    allow = 0;
    validar();
    return;
  } else {
    text = str
      .replaceAll("u", "ufat")
      .replaceAll("o", "ober")
      .replaceAll("i", "imes")
      .replaceAll("e", "enter")
      .replaceAll("a", "ai");
    return showText(text);
  }
}

function decriptText() {
  text = "";
  let str = document.getElementById("input").value;
  comprobarReglas(mayusytildes, str);
  if (str === "" || rules) {
    allow = 0;
    validar();
    return;
  } else {
    text = str
      .replaceAll("ai", "a")
      .replaceAll("enter", "e")
      .replaceAll("imes", "i")
      .replaceAll("ober", "o")
      .replaceAll("ufat", "u");
    return showText(text);
  }
}

function showText() {
  allow = 1;
  validar();
  if (document.getElementById("txt")) {
    return (document.getElementById("txt").innerHTML = text);
  } else {
    document
      .getElementById("output")
      .insertAdjacentHTML(
        "beforeend",
        '<textarea readonly id="txt" >' + text + "</textarea>"
      );
  }
}

function validar() {
  if (allow) {
    document
      .getElementById("output")
      .classList.add("text-encrypted", "text-encrypted-yes");
    document.getElementById("output").classList.remove("text-encrypted-no");
    document.getElementById("ad").classList.add("deactive");
    document.getElementById("output").classList.remove("deactive");
    document.getElementById("btn").classList.remove("deactive");
    if (document.getElementById("txt")) {
      document.getElementById("txt").classList.remove("deactive");
    }
  } else {
    document.getElementById("output").classList.add("text-encrypted-no");
    document
      .getElementById("output")
      .classList.remove("text-encrypted", "text-encrypted-yes");
    document.getElementById("ad").classList.remove("deactive");
    document.getElementById("output").classList.add("deactive");
    document.getElementById("btn").classList.add("deactive");
    if (document.getElementById("txt")) {
      document.getElementById("txt").classList.add("deactive");
    }
  }
}

function copyToClipboard() {
  if (document.getElementById("txt")) {
    var content = document.getElementById("txt").innerHTML;
    navigator.clipboard
      .writeText(content)
      .then(() => {
        showCopyMessage();
        console.log("Text copied to clipboard...");
      })
      .catch((err) => {
        console.log("Something went wrong", err);
      });
  } else {
    return;
  }
}

function comprobarReglas(arr, val) {
  for (let i = 0; i < val.length; i++) {
    if (arr.some((arrVal) => val[i] === arrVal)) {
      contarAdelante();
      return (rules = 1);
    } else {
      rules = 0;
    }
  }
  return rules;
}

function contarAdelante() {
  setTimeout(mostrarMensaje, 1);
}

function contarAtras() {
  setTimeout(quitarMensaje, 1000);
}

function mostrarMensaje() {
  show.classList.add("enfocar");
  contarAtras();
}

function quitarMensaje() {
  show.classList.remove("enfocar");
}

function showCopyMessage() {
  document
    .getElementById("body-modal")
    .insertAdjacentHTML(
      "beforeend",
      '<div id="bgmodals-id" class="bg-modal"></div><div id="modalabs-id" class="modal-abs"><p>&#10004;</p><p>¡Copiado!</p><p>Su selección ha sido copiada en el portapapeles</p></div>'
    );
  setTimeout(quitCopyMessage, 1000);
}

function quitCopyMessage() {
  document.getElementById("body-modal").classList.remove("modal-rel");
  document.getElementById("modalabs-id").remove();
  document.getElementById("bgmodals-id").remove();
}
</script>
